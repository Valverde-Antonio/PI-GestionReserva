<div class="historial-wrapper">
  <h2>Histórico de Reservas</h2>

  <div class="filtros mb-4">
    <div class="row g-3">
      <div class="mb-3 text-end">
        <button class="btn btn-success" (click)="exportarPDFMisReservas()" [disabled]="historialFiltrado.length === 0">
          Exportar a PDF
        </button>
      </div>
      <div class="col-md-4">
        <label class="form-label">Filtrar por fecha:</label>
        <input type="date" class="form-control" [(ngModel)]="filtroFecha" (change)="filtrarHistorial()">
      </div>
      <div class="col-md-4">
        <label class="form-label">Filtrar por tipo de material:</label>
        <select class="form-select" [(ngModel)]="filtroMaterial" (change)="filtrarHistorial()">
          <option value="">Todos</option>
          <option value="proyector">Proyector</option>
          <option value="portátil">Portátiles</option>
          <option value="pizarra">Pizarra Digital</option>
        </select>
      </div>
      <div class="col-md-4 d-flex align-items-end">
        <button class="btn btn-secondary w-100" (click)="limpiarFiltros()">Limpiar filtros</button>
      </div>
    </div>
  </div>

  <div *ngIf="historialFiltrado.length > 0; else noHistorial">
    <div class="reserva-card" *ngFor="let h of historialFiltrado">
      <h3>{{ h.espacio }}</h3>
      <p><strong>Recurso:</strong> {{ h.recurso }}</p>
      <p><strong>Fecha:</strong> {{ h.fecha }}</p>
      <p><strong>Hora:</strong> {{ h.horaInicio }} - {{ h.horaFin }}</p>
      <p><strong>Estado:</strong>
        <span class="estado" [class.finalizada]="h.estado === 'Finalizada'" [class.cancelada]="h.estado === 'Cancelada'">
          {{ h.estado }}
        </span>
      </p>
    </div>
  </div>

  <ng-template #noHistorial>
    <div class="sin-historial">
      <p>No hay reservas registradas con los filtros actuales.</p>
      <img src="assets/img/no-history.png" alt="Sin historial" />
    </div>
  </ng-template>
</div>
